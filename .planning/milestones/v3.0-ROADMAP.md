# Milestone v3.0: The Gauntlet

**Status:** SHIPPED 2026-01-21
**Phases:** 20-22
**Total Plans:** 11

## Overview

Fast-paced endurance mode where players face sequential 1v1 duels against AI, carrying dice between matches until eliminated. Features global leaderboard with daily reset and achievement system for milestone streaks.

## Phases

### Phase 20: Core Gauntlet Loop & Transitions

**Goal**: Player can play sequential 1v1 duels with persistent dice and cinematic transitions

**Dependencies**: None (builds on existing single-player infrastructure)

**Plans**: 3 plans

Plans:
- [x] 20-01-PLAN.md — Gauntlet store and mode entry (RulesScreen)
- [x] 20-02-PLAN.md — Transition UI components (FightCard, VictorySplash, GameOverScreen, StreakCounter)
- [x] 20-03-PLAN.md — GauntletModeScreen integration and full flow wiring

**Details:**
- Gauntlet state store manages playerDiceCount, streak, currentRound with AI escalation logic
- RulesScreen component with dramatic dark styling
- Fight cards with Tekken-style opponent introduction
- Victory splash emphasizing gauntlet continues
- Game over screen with instant retry

---

### Phase 21: Leaderboard System

**Goal**: Players can submit scores to a global leaderboard and see how they rank

**Dependencies**: Phase 20 (requires completed Gauntlet runs to generate scores)

**Plans**: 5 plans

Plans:
- [x] 21-01-PLAN.md — D1 database infrastructure and leaderboard Worker skeleton
- [x] 21-02-PLAN.md — Client-side personal best tracking with localStorage
- [x] 21-03-PLAN.md — Leaderboard API endpoints (submit, fetch, rank, near)
- [x] 21-04-PLAN.md — Scheduled Worker for daily leaderboard reset
- [x] 21-05-PLAN.md — Leaderboard UI (LeaderboardScreen, SubmitScoreModal, countdown timer)

**Details:**
- Cloudflare D1 for persistent leaderboard storage
- Daily reset at midnight UTC with countdown timer
- Top 100 scores with "near you" section
- Personal best tracking in localStorage
- Score fraud limits reject impossible scores (>1000)

---

### Phase 22: Achievement System

**Goal**: Players earn achievements for milestones and special accomplishments

**Dependencies**: Phase 20 (requires working Gauntlet to track progress)

**Plans**: 3 plans

Plans:
- [x] 22-01-PLAN.md — Achievement system core (definitions, types, localStorage persistence)
- [x] 22-02-PLAN.md — Achievement detection and toast notifications
- [x] 22-03-PLAN.md — Achievement gallery (progress display removed per user request)

**Details:**
- 5 milestone achievements at 5, 10, 25, 50, 100 streak
- 7 hidden achievements for special conditions
- Toast notifications with golden/amber (milestones) or purple (hidden) accent
- Achievement gallery accessible from Gauntlet intro screen
- Achievements persist in localStorage

---

## Milestone Summary

**Key Decisions:**

- No healing in Gauntlet (pure endurance test)
- AI opponents always start with 5 dice (fair challenge)
- Escalating AI difficulty: Turtle (1-3) → Calculator (4-6) → Shark (7+)
- Cloudflare D1 for leaderboard (5M reads/day free tier)
- Daily leaderboard resets at midnight UTC
- Achievements stored in localStorage (no account needed)
- Achievement progress indicator removed (toast-only per user preference)
- Achievement gallery in Gauntlet section (not main menu)

**Issues Resolved:**

- D1 binding configuration for PartyKit
- CORS handling for leaderboard API
- Mock mode for local D1 development

**Issues Deferred:**

- Sound effects still placeholders
- AI DUDO bug on guaranteed bids (pre-existing)

**Technical Debt Incurred:**

- None

---

*For current project status, see .planning/ROADMAP.md*
