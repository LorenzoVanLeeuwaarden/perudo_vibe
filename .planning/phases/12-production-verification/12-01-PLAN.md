---
phase: 12-production-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/12-production-verification/12-VERIFICATION.md
  - .planning/phases/12-production-verification/12-ISSUES.md
autonomous: false

must_haves:
  truths:
    - "User can create a room and receive shareable link"
    - "Second user can join room via shareable link"
    - "Complete game playable: bidding, Dudo, Calza all work"
    - "Disconnected player reconnects and resumes game"
    - "Game ends correctly with winner/statistics displayed"
  artifacts:
    - path: ".planning/phases/12-production-verification/12-VERIFICATION.md"
      provides: "Final verification report with all test results"
      contains: "status:"
    - path: ".planning/phases/12-production-verification/12-ISSUES.md"
      provides: "Issue tracker (may be empty if all tests pass)"
      contains: "# Issues"
  key_links:
    - from: "https://faroleo.pages.dev"
      to: "https://perudo-vibe.lorenzovanleeuwaarden.partykit.dev"
      via: "WebSocket connection"
      pattern: "Room created successfully"
---

<objective>
Verify the complete Perudo multiplayer experience works end-to-end in the production environment.

Purpose: Confirm that both frontend (faroleo.pages.dev) and backend (perudo-vibe.lorenzovanleeuwaarden.partykit.dev) work together correctly for real users before declaring v2.0 deployment complete.

Output: 12-VERIFICATION.md documenting all test results, 12-ISSUES.md tracking any problems found.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-production-verification/12-CONTEXT.md
@.planning/phases/12-production-verification/12-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Automated Infrastructure Health Checks</name>
  <files>.planning/phases/12-production-verification/12-VERIFICATION.md</files>
  <action>
Run automated health checks for production URLs:

1. Frontend accessibility check:
   ```bash
   curl -s -o /dev/null -w "%{http_code}" https://faroleo.pages.dev
   ```
   Expected: 200

2. Backend endpoint check:
   ```bash
   curl -s -o /dev/null -w "%{http_code}" https://perudo-vibe.lorenzovanleeuwaarden.partykit.dev
   ```
   Expected: 404 (WebSocket server responds 404 to HTTP GET - this is correct)

3. SPA routing check (direct room URL):
   ```bash
   curl -s -o /dev/null -w "%{http_code}" https://faroleo.pages.dev/room/TESTROOM/
   ```
   Expected: 200 (404.html fallback serves page)

4. TLS certificate verification:
   ```bash
   curl -vI https://perudo-vibe.lorenzovanleeuwaarden.partykit.dev 2>&1 | grep -E "(SSL|subject|issuer)"
   ```
   Expected: Valid certificate info

Create initial 12-VERIFICATION.md with:
- Phase header and production URLs
- Infrastructure Checks section with pass/fail results
- Manual Testing section (placeholder for Task 2)
  </action>
  <verify>
- curl commands execute successfully
- 12-VERIFICATION.md created with infrastructure check results
- All automated checks pass (200 for frontend, 404 for backend, 200 for SPA route)
  </verify>
  <done>Infrastructure health checks documented in 12-VERIFICATION.md showing all endpoints accessible</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Manual Production Testing</name>
  <what-built>
Infrastructure verified. Now testing the full multiplayer experience in production.

**Production URLs:**
- Frontend: https://faroleo.pages.dev
- Backend: perudo-vibe.lorenzovanleeuwaarden.partykit.dev
  </what-built>
  <how-to-verify>
Complete the following test scenarios. For each test, report: PASS, FAIL (with description), or SKIP (with reason).

---

## Test Setup
Open 4+ browser windows/tabs (use incognito/private windows for separate sessions):
- Window 1: Primary player (will create room)
- Window 2-4: Additional players (will join room)

Browsers to test: Chrome, Safari, Firefox (at least check UI loads in all three)

---

## Test Suite

### TC-01: Room Creation (Chrome)
1. Open https://faroleo.pages.dev in Chrome
2. Click "Play with Friends"
3. Click "Create Room"
**Expected:** Room code displayed (6 characters), shareable URL shown, "Waiting for players" state
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-02: Room Join via Link (Chrome - 3 additional players)
1. Copy the shareable URL from Window 1
2. Paste into Windows 2, 3, 4
3. Enter player names and join
**Expected:** All players appear in lobby, player count updates for everyone
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-03: Cross-Browser Verification
1. Open https://faroleo.pages.dev in Safari
2. Open https://faroleo.pages.dev in Firefox
**Expected:** Home page loads correctly in both browsers, UI renders properly
**Result (Safari):** [ ] PASS [ ] FAIL: ___________
**Result (Firefox):** [ ] PASS [ ] FAIL: ___________

### TC-04: Start Game and Roll Dice
1. In Window 1 (host), configure settings (optional: enable timer)
2. Click "Start Game"
3. All players should see dice rolling animation
**Expected:** Game transitions to rolling phase, each player sees their hand (5 dice)
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-05: Bidding Round
1. First player places a bid (e.g., "3 fives")
2. Next player raises bid (higher quantity or same quantity higher value)
3. Continue bidding around
**Expected:** Bid UI works, bids validated (can't lower), turn indicator moves correctly
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-06: Dudo Call
1. When bid seems high, current player clicks "Dudo!"
**Expected:** All hands revealed, dice counted, correct player loses a die, round restarts
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-07: Calza Call (if opportunity arises)
1. If a bid is exactly correct, non-bidding player can call "Calza!"
**Expected:** If Calza correct, caller gains a die (max 5). If wrong, caller loses a die.
**Result:** [ ] PASS [ ] FAIL [ ] SKIP (no Calza opportunity): ___________

### TC-08: Palifico Round (if opportunity arises)
1. When a player reaches 1 die, next round is Palifico
**Expected:** First bid locks the value, subsequent bids must use same value (only quantity changes)
**Result:** [ ] PASS [ ] FAIL [ ] SKIP (no Palifico yet): ___________

### TC-09: Disconnect/Reconnect
1. In one player window, go offline:
   - Chrome: DevTools > Network tab > Offline checkbox
   - Or: Airplane mode / disconnect network
2. Wait 5+ seconds
3. Other players should see:
   - Immediate: WiFi-off icon on disconnected player
   - After 5 seconds: Player card grays out
4. Reconnect (uncheck Offline / restore network)
**Expected:**
- Disconnected player sees "Welcome back!" toast
- Other players see player un-gray and reconnect notification
- Game state preserved (same dice, same turn position)
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-10: AI Takeover on Disconnect (if disconnected player's turn)
1. During a player's turn, disconnect that player
2. Wait for turn timer (default 30s) or AI takeover (5s after disconnect)
**Expected:** AI makes a conservative bid, bot badge appears on player card
**Result:** [ ] PASS [ ] FAIL [ ] SKIP (not player's turn): ___________

### TC-11: Game End
1. Continue playing until one player wins (last player with dice)
**Expected:**
- Winner announcement displayed
- Game statistics shown (rounds played, dice lost, etc.)
- Option to play again or return to lobby
**Result:** [ ] PASS [ ] FAIL: ___________

### TC-12: Mobile Viewport (Optional but Recommended)
1. In Chrome: DevTools > Toggle device toolbar (mobile icon) > Select iPhone or similar
2. Test basic flow: create/join room, see dice, place bid
**Expected:** Responsive design works, touch targets usable, no layout breaks
**Result:** [ ] PASS [ ] FAIL [ ] SKIP: ___________

---

## Summary
After completing all tests, provide:
1. Total PASS count: ___/12
2. Any FAIL descriptions
3. Any observations or minor issues noticed
  </how-to-verify>
  <resume-signal>
Report results in this format:
```
TC-01: PASS/FAIL (details if fail)
TC-02: PASS/FAIL
... (all 12 tests)

Summary: X/12 passed
Issues found: (list any)
Observations: (any notes)
```
  </resume-signal>
</task>

<task type="auto">
  <name>Task 3: Create Final Verification Report and Issues Log</name>
  <files>.planning/phases/12-production-verification/12-VERIFICATION.md, .planning/phases/12-production-verification/12-ISSUES.md</files>
  <action>
Based on user's test results from Task 2, complete the verification documentation:

**12-VERIFICATION.md:**
1. Update frontmatter with final status (passed/failed/partial)
2. Fill in Manual Testing Results table with pass/fail for each TC
3. Add "Requirements Coverage" section mapping tests to VERF-01 through VERF-04
4. Add "Summary" section with overall assessment
5. Include any observations from user

**12-ISSUES.md:**
1. Create file with standard issue tracking header
2. If all tests passed: Document as "No issues found"
3. If any tests failed: Create issue entry for each failure with:
   - Severity (Critical/Major/Minor)
   - Test case ID
   - Steps to reproduce
   - Expected vs actual behavior
   - Browser/device info

Final verification report should follow format from prior phases (see 10-VERIFICATION.md, 11-VERIFICATION.md for structure).
  </action>
  <verify>
- 12-VERIFICATION.md is complete with all test results
- 12-ISSUES.md exists (may be empty if no issues)
- Status reflects actual test outcomes
- Requirements VERF-01 through VERF-04 mapped to test results
  </verify>
  <done>
Complete verification documentation exists showing:
- All 12 test cases documented
- Pass/fail status for each test
- Issues logged if any failures
- Overall phase status determined
  </done>
</task>

</tasks>

<verification>
Phase verification complete when:
1. Infrastructure health checks pass (automated)
2. All manual test cases executed and documented
3. 12-VERIFICATION.md has final status
4. 12-ISSUES.md created (even if empty)
5. Requirements VERF-01 through VERF-04 have coverage determination
</verification>

<success_criteria>
Phase 12 succeeds when:
- Room creation works in production (VERF-01)
- Join via shareable link works (VERF-02)
- Full gameplay works: bidding, Dudo, Calza (VERF-03)
- Disconnect/reconnect works (VERF-04)
- Game end with winner display works
- All tests documented in VERIFICATION.md

Note: If issues are found, they should be documented in ISSUES.md. Phase may need follow-up fixes before v2.0 can be declared complete.
</success_criteria>

<output>
After completion, create `.planning/phases/12-production-verification/12-01-SUMMARY.md`
</output>
