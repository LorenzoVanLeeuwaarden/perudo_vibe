---
phase: 24-tutorial-guidance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/tutorial/TutorialTooltip.tsx
  - src/components/tutorial/TutorialOverlay.tsx
  - src/components/tutorial/DisabledButtonWrapper.tsx
  - src/components/tutorial/index.ts
autonomous: true

must_haves:
  truths:
    - "Tooltip appears with arrow pointing at target element"
    - "Click anywhere on overlay dismisses tooltip"
    - "Disabled buttons show explanation on hover/focus"
    - "All components use player color theming"
  artifacts:
    - path: "src/components/tutorial/TutorialTooltip.tsx"
      provides: "Tooltip with arrow pointer and player-color border"
      exports: ["TutorialTooltip"]
    - path: "src/components/tutorial/TutorialOverlay.tsx"
      provides: "Click-to-dismiss backdrop overlay"
      exports: ["TutorialOverlay"]
    - path: "src/components/tutorial/DisabledButtonWrapper.tsx"
      provides: "Wrapper for disabled buttons with hover tooltip"
      exports: ["DisabledButtonWrapper"]
  key_links:
    - from: "src/components/tutorial/TutorialTooltip.tsx"
      to: "framer-motion"
      via: "motion.div for enter/exit animations"
      pattern: "motion\\.div.*initial.*animate"
    - from: "src/components/tutorial/TutorialOverlay.tsx"
      to: "onClick handler"
      via: "onDismiss callback"
      pattern: "onClick.*onDismiss"
---

<objective>
Create tutorial tooltip components for Phase 24 guidance system.

Purpose: Build reusable tooltip, overlay, and disabled-button-wrapper components that will be used throughout the tutorial to explain concepts and constrain actions.
Output: Three new components (TutorialTooltip, TutorialOverlay, DisabledButtonWrapper) exported from tutorial barrel.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-tutorial-guidance/24-CONTEXT.md
@.planning/phases/24-tutorial-guidance/24-RESEARCH.md
@src/lib/types.ts (for PlayerColor, PLAYER_COLORS)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TutorialTooltip component</name>
  <files>src/components/tutorial/TutorialTooltip.tsx</files>
  <action>
Create TutorialTooltip component with Framer Motion animations.

Props interface:
- content: string (tooltip text)
- position: 'top' | 'bottom' | 'left' | 'right' (arrow direction)
- playerColor: PlayerColor (for border/glow theming)
- onDismiss?: () => void (optional, for click-to-continue)
- targetRef?: React.RefObject<HTMLElement> (optional, for dynamic positioning)
- style?: React.CSSProperties (for manual positioning override)

Implementation:
1. Use motion.div with AnimatePresence-compatible animations:
   - initial: { opacity: 0, scale: 0.9 }
   - animate: { opacity: 1, scale: 1 }
   - exit: { opacity: 0, scale: 0.9 }
2. CSS triangle arrow using border technique:
   - Position based on `position` prop (top = arrow points up, etc.)
   - Arrow color matches playerColor border
3. Tooltip body styling:
   - Dark background: rgba(13, 4, 22, 0.95)
   - 2px border with PLAYER_COLORS[playerColor].border
   - Box shadow with PLAYER_COLORS[playerColor].glow
   - Rounded corners (rounded-lg), padding (p-4)
   - Text: text-sm text-white-soft
4. Fixed positioning with z-[100] to appear above game elements
5. If targetRef provided, calculate position from getBoundingClientRect()
6. If style provided, use it as override for manual positioning

Friendly persona per CONTEXT.md: warm, welcoming tone (text content comes from script, not hardcoded here).
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>TutorialTooltip component renders with arrow pointing in correct direction and player-color theming</done>
</task>

<task type="auto">
  <name>Task 2: Create TutorialOverlay and DisabledButtonWrapper</name>
  <files>src/components/tutorial/TutorialOverlay.tsx, src/components/tutorial/DisabledButtonWrapper.tsx</files>
  <action>
Create TutorialOverlay component:
- Full-screen fixed overlay with semi-transparent background (rgba(0, 0, 0, 0.3))
- z-[99] to sit behind tooltip (z-[100]) but above game elements
- onClick calls onDismiss prop
- onClick handler must call e.stopPropagation() to prevent tap-through on mobile
- Framer Motion animations: opacity 0->1 on enter, 1->0 on exit
- cursor-pointer to indicate clickable

Create DisabledButtonWrapper component:
- Wrapper div with tabIndex={0} for keyboard accessibility
- aria-label set to tooltipText for screen readers
- Shows tooltip on hover (onMouseEnter/Leave) and focus (onFocus/onBlur)
- Tooltip positioned above button (bottom-full) with small margin (mb-2)
- Tooltip styled to match TutorialTooltip (dark bg, player-color border)
- Uses AnimatePresence for tooltip enter/exit
- Tooltip is pointer-events-none to prevent interference

Props for DisabledButtonWrapper:
- children: React.ReactNode (the disabled button)
- tooltipText: string (explanation of why disabled)
- playerColor: PlayerColor

Both components must handle mobile touch events correctly (stopPropagation on overlay click).
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>TutorialOverlay dismisses on click; DisabledButtonWrapper shows tooltip on hover/focus</done>
</task>

<task type="auto">
  <name>Task 3: Export components from tutorial barrel</name>
  <files>src/components/tutorial/index.ts</files>
  <action>
Update the tutorial barrel export to include new components:

```typescript
export { TutorialTooltip } from './TutorialTooltip';
export { TutorialOverlay } from './TutorialOverlay';
export { DisabledButtonWrapper } from './DisabledButtonWrapper';
```

Add these exports alongside existing exports (TutorialGameplay, TutorialScreen, TutorialComplete).
  </action>
  <verify>`npm run build` succeeds with no errors</verify>
  <done>All three new components exported and importable from '@/components/tutorial'</done>
</task>

</tasks>

<verification>
1. TypeScript compilation: `npx tsc --noEmit` passes
2. Build succeeds: `npm run build` completes without errors
3. Components are importable: Can import { TutorialTooltip, TutorialOverlay, DisabledButtonWrapper } from '@/components/tutorial'
</verification>

<success_criteria>
- TutorialTooltip renders with configurable position and player-color theming
- TutorialOverlay covers screen and dismisses on click
- DisabledButtonWrapper shows accessible tooltip on hover/focus
- All components use Framer Motion for animations
- Build passes with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/24-tutorial-guidance/24-01-SUMMARY.md`
</output>
