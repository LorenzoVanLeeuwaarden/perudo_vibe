---
phase: 24-tutorial-guidance
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/tutorial/types.ts
  - src/lib/tutorial/script.ts
autonomous: true

must_haves:
  truths:
    - "Each tutorial step has tooltip content and position"
    - "Steps specify which dice to highlight (by value, not index)"
    - "Steps specify which button to highlight (bid or dudo)"
    - "Steps specify dismiss mode (click or auto-advance)"
  artifacts:
    - path: "src/lib/tutorial/types.ts"
      provides: "TutorialTooltip, HighlightDice, TutorialStep extensions"
      contains: "tooltip?: TutorialTooltipData"
    - path: "src/lib/tutorial/script.ts"
      provides: "TUTORIAL_SCRIPT with guidance data for all 6 steps"
      contains: "tooltip:"
  key_links:
    - from: "src/lib/tutorial/script.ts"
      to: "src/lib/tutorial/types.ts"
      via: "TutorialStep interface"
      pattern: "TutorialStep"
---

<objective>
Enhance tutorial script with tooltip content, dice highlighting, and button highlighting data.

Purpose: Add the guidance metadata to each tutorial step so TutorialGameplay knows what to show and highlight.
Output: Extended TutorialStep type with tooltip/highlight fields, TUTORIAL_SCRIPT populated with guidance for all 6 steps.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-tutorial-guidance/24-CONTEXT.md
@.planning/phases/24-tutorial-guidance/24-RESEARCH.md
@src/lib/tutorial/types.ts
@src/lib/tutorial/script.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend TutorialStep type with guidance fields</name>
  <files>src/lib/tutorial/types.ts</files>
  <action>
Add new types and extend TutorialStep interface:

```typescript
/**
 * Tooltip data for a tutorial step.
 * Position indicates where tooltip appears relative to target.
 */
export interface TutorialTooltipData {
  /** The tooltip message (1-2 sentences, friendly tone) */
  content: string;
  /** Where tooltip appears relative to target element */
  position: 'top' | 'bottom' | 'left' | 'right';
  /** Which element the tooltip points to */
  targetElement: 'player-dice' | 'bid-button' | 'dudo-button' | 'bid-display' | 'opponent-dice';
  /** How to dismiss: click anywhere or auto-advance after delay */
  dismissMode: 'click' | 'auto';
  /** Delay in ms for auto-advance mode */
  autoAdvanceDelay?: number;
}

/**
 * Dice highlighting configuration.
 * Highlights by value (not index) to work correctly with sorted dice.
 */
export interface HighlightDiceConfig {
  /** How to determine which dice to highlight */
  type: 'matching-value' | 'jokers' | 'all';
  /** The value to match (for 'matching-value' type) */
  value?: number;
  /** Which hands to highlight: 'player', 0 (Alex), 1 (Sam) */
  targets: ('player' | 0 | 1)[];
}
```

Extend TutorialStep interface to include:
```typescript
/** Tooltip to show during this step */
tooltip?: TutorialTooltipData;

/** Which dice to highlight (by value, works with sorted display) */
highlightDice?: HighlightDiceConfig;

/** Which button to highlight with pulsing glow */
highlightButton?: 'bid' | 'dudo';
```
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>TutorialStep interface includes tooltip, highlightDice, and highlightButton optional fields</done>
</task>

<task type="auto">
  <name>Task 2: Add guidance data to TUTORIAL_SCRIPT steps</name>
  <files>src/lib/tutorial/script.ts</files>
  <action>
Update each of the 6 steps in TUTORIAL_SCRIPT with tooltip and highlighting data.

Per CONTEXT.md decisions:
- Friendly guide persona: "Let's see what you rolled!", "You have two 3s!"
- Click-to-continue for key concepts (rules explanations, reveal outcomes)
- Auto-advance (~1.5s) for observation steps (AI turns)
- AI opponents "think" for 1-2s before acting

Step 0 (roll-dice): Observation
- tooltip: { content: "Welcome! These are your dice. In tutorial mode, you can see everyone's dice to learn how the game works.", position: 'bottom', targetElement: 'player-dice', dismissMode: 'click' }
- No highlighting (let user absorb the view)

Step 1 (first-bid): Player bids
- tooltip: { content: "You have two 3s! Let's start with a safe bid: 3x threes. Click BID to confirm.", position: 'top', targetElement: 'bid-button', dismissMode: 'click' }
- highlightDice: { type: 'matching-value', value: 3, targets: ['player'] }
- highlightButton: 'bid'

Step 2 (alex-bids): Observe Alex
- tooltip: { content: "Alex is thinking...", position: 'top', targetElement: 'opponent-dice', dismissMode: 'auto', autoAdvanceDelay: 1500 }
- highlightDice: { type: 'matching-value', value: 4, targets: [0] } (highlight Alex's 4s)
- After AI move, show follow-up: "Alex bid 4x fours. Each bid must be higher than the last!"

Step 3 (sam-bids): Observe Sam
- tooltip: { content: "Sam is thinking...", position: 'top', targetElement: 'opponent-dice', dismissMode: 'auto', autoAdvanceDelay: 1500 }
- After AI move, show follow-up: "Sam bid 5x fives. That seems high... let's count!"

Step 4 (player-dudo): Player calls Dudo
- tooltip: { content: "You have 1 five. Alex has 0. Sam has 2. That's only 3 fives total! Sam's bid of 5x fives is wrong. Call DUDO!", position: 'top', targetElement: 'dudo-button', dismissMode: 'click' }
- highlightDice: { type: 'matching-value', value: 5, targets: ['player', 0, 1] }
- highlightButton: 'dudo'

Step 5 (reveal): Watch reveal
- No tooltip initially (DudoOverlay handles the drama)
- After reveal complete, show: "You were right! Sam loses a die for overbidding."

Note: The tooltip content and flow may need adjustment during integration. These are starting values based on the scripted dice values and CONTEXT.md guidance.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>All 6 steps have tooltip and highlighting data defined</done>
</task>

</tasks>

<verification>
1. TypeScript compilation: `npx tsc --noEmit` passes
2. TUTORIAL_SCRIPT.steps[0].tooltip exists and has correct structure
3. TUTORIAL_SCRIPT.steps[1].highlightDice specifies value: 3
4. TUTORIAL_SCRIPT.steps[4].highlightButton equals 'dudo'
</verification>

<success_criteria>
- TutorialStep type extended with tooltip, highlightDice, highlightButton
- All 6 steps in TUTORIAL_SCRIPT have guidance data
- Tooltip content uses friendly, welcoming tone per CONTEXT.md
- Dice highlighting uses value-based matching (not index)
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/24-tutorial-guidance/24-02-SUMMARY.md`
</output>
