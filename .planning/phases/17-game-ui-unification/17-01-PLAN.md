---
phase: 17-game-ui-unification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/GameBoard.tsx
autonomous: true

must_haves:
  truths:
    - "Multiplayer bid display uses same recessed table surface styling as single-player"
    - "Multiplayer player's dice section uses shelf layout with radial glow (not retro-panel)"
    - "BidUI in multiplayer uses hideBidDisplay={true} like single-player"
    - "PlayerDiceBadge renders identically in both single-player and multiplayer"
  artifacts:
    - path: "src/components/GameBoard.tsx"
      provides: "Unified bidding phase layout matching single-player"
      contains: "hideBidDisplay={true}"
    - path: "src/components/PlayerDiceBadge.tsx"
      provides: "Shared player badge component used by both modes"
  key_links:
    - from: "src/components/GameBoard.tsx"
      to: "BidUI"
      via: "hideBidDisplay prop"
      pattern: "hideBidDisplay=\\{true\\}"
    - from: "src/components/GameBoard.tsx"
      to: "PlayerDiceBadge"
      via: "import and usage"
      pattern: "import.*PlayerDiceBadge"
    - from: "src/app/page.tsx"
      to: "PlayerDiceBadge"
      via: "import and usage"
      pattern: "import.*PlayerDiceBadge"
---

<objective>
Unify GameBoard bidding phase styling with single-player

Purpose: Make multiplayer game UI visually consistent with single-player during the bidding phase. Single-player is the source of truth (per CONTEXT.md).

Output: GameBoard.tsx updated with:
1. Custom bid display matching single-player's recessed table surface style
2. Player dice shelf with radial glow (replacing retro-panel wrapper)
3. BidUI using hideBidDisplay={true}
4. Verified PlayerDiceBadge consistency between modes
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-game-ui-unification/17-CONTEXT.md
@.planning/phases/17-game-ui-unification/17-RESEARCH.md
@src/components/GameBoard.tsx
@src/app/page.tsx (lines 1566-1733 for bid display and player shelf patterns)
@src/lib/types.ts (PLAYER_COLORS)
@src/components/PlayerDiceBadge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add custom bid display matching single-player style</name>
  <files>src/components/GameBoard.tsx</files>
  <action>
Add a custom bid display component in GameBoard's bidding phase that matches single-player's "recessed table surface" pattern.

Reference single-player implementation (page.tsx lines 1566-1655):

1. Import PLAYER_COLORS from '@/lib/types'

2. Add imports for useIsFirefox and useReducedMotion from '@/hooks/' (needed for glow animation)

3. Replace the current BidUI rendering (lines 235-248) with:
   - A custom bid display ABOVE BidUI (when currentBid exists)
   - Pass `hideBidDisplay={true}` to BidUI

4. Custom bid display structure (matching single-player):
   - Wrapper with perspective: '800px'
   - Circular player token (absolute positioned -top-3 -left-3) showing lastBidderName.slice(0,3)
   - Token uses PLAYER_COLORS[lastBidderColor] for gradient, glow, border
   - Inner recessed surface div with:
     - Background: 'linear-gradient(180deg, rgba(3, 15, 15, 0.95) 0%, rgba(10, 31, 31, 0.9) 100%)'
     - Complex box-shadow (inset shadows + outer glow)
     - Border: '2px solid rgba(45, 212, 191, 0.15)'
     - Subtle floating animation (y: [0, -3, 0, 3, 0], rotateX: [5, 5.3, 5, 4.7, 5]) - guard for reduced motion
   - Dice display: Map currentBid.count dice using Dice component with lastBidderColor
   - Count text: "{count}x {value}s" or "Jokers" if value is 1

5. Keep TurnTimer above the bid display (same position)

6. When no bid exists and it's player's turn, show "Make the opening bid" message (like single-player line 1658-1668)

IMPORTANT: Use useSimplifiedAnimations pattern (isFirefox || prefersReducedMotion) to guard the floating animation.
  </action>
  <verify>
Run `npm run build` - should compile without errors
Visual check: Multiplayer bid display should have the same recessed table appearance as single-player
  </verify>
  <done>
Multiplayer shows custom bid display with recessed table surface, circular player token, and floating animation matching single-player exactly
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace retro-panel dice wrapper with shelf layout</name>
  <files>src/components/GameBoard.tsx</files>
  <action>
Replace the "Your Dice" retro-panel wrapper with single-player's shelf layout pattern.

Reference single-player implementation (page.tsx lines 1691-1733):

1. Replace the current player dice section (lines 266-286) with:

   - Outer motion.div with:
     - initial={{ y: 50, opacity: 0 }}
     - animate={{ y: 0, opacity: 1 }}
     - transition={{ type: 'spring', stiffness: 300, damping: 25 }}
     - className="flex-none pb-4 relative"

   - Radial glow div (absolute positioned):
     - className="absolute inset-x-0 bottom-0 h-32 pointer-events-none"
     - style: background radial-gradient using PLAYER_COLORS[myColor].glow
     - opacity: 0.35

   - Inner motion.div for dice container:
     - className="relative flex justify-center items-end"
     - For useSimplifiedAnimations: static filter with drop-shadow
     - For full animations: animate filter cycling through drop-shadow intensities (12px -> 25px -> 12px)
     - transition: duration 2, repeat Infinity

   - SortedDiceDisplay inside with existing props, add:
     - animateSort={true}
     - size="lg" (upgrade from "md")
     - highlightValue logic: if not my turn, highlight currentBid?.value

2. Remove the "Your Dice" label (single-player doesn't have it)

3. Remove the retro-panel wrapper completely

IMPORTANT: Guard the filter animation using useSimplifiedAnimations pattern.
  </action>
  <verify>
Run `npm run build` - should compile without errors
Visual check: Player's dice should have radial glow from bottom and pulsing drop-shadow (no panel border)
  </verify>
  <done>
Multiplayer player dice section uses shelf layout with radial glow, matching single-player's visual style exactly
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify PlayerDiceBadge consistency between modes</name>
  <files>src/components/PlayerDiceBadge.tsx, src/components/GameBoard.tsx, src/app/page.tsx</files>
  <action>
Verify that PlayerDiceBadge renders identically in both single-player and multiplayer modes. Research indicates the component is already shared.

1. Confirm PlayerDiceBadge import:
   - Check GameBoard.tsx imports PlayerDiceBadge from '@/components/PlayerDiceBadge'
   - Check page.tsx imports PlayerDiceBadge from '@/components/PlayerDiceBadge' (or same source)
   - Both should use the SAME component file

2. Compare props passed in each mode:
   - Single-player (page.tsx): Check PlayerDiceBadge usage, note all props passed
   - Multiplayer (GameBoard.tsx): Check PlayerDiceBadge usage, note all props passed
   - Document any differences in props usage

3. Verify visual consistency:
   - Both modes should pass same core props: playerName, diceCount, color, isActive
   - Multiplayer may additionally pass: showDisconnectedVisual, isConnected (these are optional)
   - These optional props should NOT change appearance when not passed

4. If any differences found that affect visual appearance:
   - Align the props passed to match single-player's usage
   - Ensure any multiplayer-specific props (disconnect indicators) don't alter base styling

5. Document findings in verification output
  </action>
  <verify>
Run grep to confirm same import path:
- `grep -n "import.*PlayerDiceBadge" src/components/GameBoard.tsx src/app/page.tsx`
Both should import from same source (e.g., '@/components/PlayerDiceBadge')

Run `npm run build` - no errors related to PlayerDiceBadge
  </verify>
  <done>
PlayerDiceBadge confirmed to use identical component in both modes. Any prop differences documented. GAME-02 requirement satisfied.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. Start dev server: `npm run dev`
3. Navigate to multiplayer game (create room, join, start game)
4. During bidding phase:
   - Bid display shows recessed table surface with floating animation
   - Player token (3-letter abbreviation) appears when there's a current bid
   - Player's dice at bottom have radial glow, no panel border
   - Dice glow pulses smoothly (or static on Firefox/reduced-motion)
   - PlayerDiceBadge row at top looks identical to single-player
5. Compare visually with single-player bidding phase - should feel identical
</verification>

<success_criteria>
- GAME-01 satisfied: Multiplayer GameBoard bidding phase matches single-player styling
- GAME-02 satisfied: PlayerDiceBadge looks identical in both single-player and multiplayer (verified same component, same base styling)
- GAME-03 satisfied: BidUI uses hideBidDisplay={true} in multiplayer, consistent with single-player
- Build passes without errors
- Visual consistency between single-player and multiplayer bidding phases
</success_criteria>

<output>
After completion, create `.planning/phases/17-game-ui-unification/17-01-SUMMARY.md`
</output>
