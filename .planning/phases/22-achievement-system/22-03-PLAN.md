---
phase: 22-achievement-system
plan: 03
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/components/gauntlet/AchievementProgress.tsx
  - src/components/gauntlet/AchievementGallery.tsx
  - src/components/gauntlet/index.ts
  - src/components/gauntlet/GauntletModeScreen.tsx
  - src/components/ModeSelection.tsx
  - src/app/page.tsx
autonomous: false

must_haves:
  truths:
    - "Progress indicator shows X/Y to next milestone during gameplay"
    - "Achievement gallery is accessible from main menu"
    - "Locked achievements show as silhouette with mystery text"
    - "Unlocked achievements show name, description, and unlock date"
  artifacts:
    - path: "src/components/gauntlet/AchievementProgress.tsx"
      provides: "Progress indicator component"
      min_lines: 30
    - path: "src/components/gauntlet/AchievementGallery.tsx"
      provides: "Achievement gallery screen"
      min_lines: 100
  key_links:
    - from: "src/components/gauntlet/GauntletModeScreen.tsx"
      to: "src/components/gauntlet/AchievementProgress.tsx"
      via: "renders during gameplay"
      pattern: "AchievementProgress"
    - from: "src/app/page.tsx"
      to: "src/components/gauntlet/AchievementGallery.tsx"
      via: "renders gallery screen"
      pattern: "AchievementGallery"
---

<objective>
Create progress display during runs and achievement gallery accessible from main menu.

Purpose: Let players track progress toward milestones and view their achievement collection.

Output: Progress indicator component, gallery component, and main menu integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-achievement-system/22-CONTEXT.md
@.planning/phases/22-achievement-system/22-01-SUMMARY.md

# Files to modify
@src/components/gauntlet/GauntletModeScreen.tsx
@src/components/ModeSelection.tsx
@src/app/page.tsx

# Achievement system from Plan 01
@src/lib/achievements.ts
@src/stores/achievementStore.ts

# Existing patterns
@src/components/gauntlet/StreakCounter.tsx (positioning reference)
@src/components/gauntlet/LeaderboardScreen.tsx (full-screen pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Achievement progress indicator</name>
  <files>src/components/gauntlet/AchievementProgress.tsx, src/components/gauntlet/index.ts</files>
  <action>
Create progress indicator for next milestone achievement:

1. AchievementProgress component props:
   - currentStreak: number
   - className?: string (for positioning)

2. Logic:
   - Use getProgressToNext(currentStreak) from achievements.ts
   - If null (all milestones achieved), show "All milestones complete!" or similar
   - Otherwise show progress to next milestone

3. Visual design:
   - Compact display to fit near StreakCounter
   - Format per Claude's discretion: could be "3/5 to Dice Apprentice" or "2 more for Dice Apprentice"
   - Subtle styling - should not compete with StreakCounter
   - Dark background with muted text, slight amber/gold accent

4. Animation:
   - Subtle pulse when progress increments (key={currentStreak})
   - Respect useReducedMotion

5. Hidden achievement note:
   - NEVER show progress toward hidden achievements (per CONTEXT.md)
   - This component only tracks milestone progress

6. Export from index.ts
  </action>
  <verify>
    - Component compiles: `npx tsc --noEmit src/components/gauntlet/AchievementProgress.tsx`
    - Export added to index.ts
  </verify>
  <done>
    - Progress indicator shows next milestone target
    - Displays current/target format
    - Updates as streak increases
    - Handles "all complete" state
  </done>
</task>

<task type="auto">
  <name>Task 2: Achievement gallery component</name>
  <files>src/components/gauntlet/AchievementGallery.tsx, src/components/gauntlet/index.ts</files>
  <action>
Create full-screen achievement gallery:

1. AchievementGallery component props:
   - onBack: () => void (return to previous screen)

2. Layout:
   - Full-screen overlay (similar to LeaderboardScreen pattern)
   - Dark background with subtle gradient
   - Header with "Achievements" title and back button
   - Grid of achievement cards (responsive: 2 cols mobile, 3-4 cols desktop)
   - Scrollable if many achievements

3. Achievement card states:
   a. Unlocked achievement:
      - Full color display
      - Icon rendered with lucide-react
      - Achievement name and description
      - Unlock date: "Unlocked Jan 21, 2026" format
      - Subtle glow/highlight effect

   b. Locked achievement (milestone):
      - Grayed out / silhouette style
      - Icon shown but dimmed
      - Name shown but description shows threshold: "Defeat 5 opponents"
      - Text: "Locked"

   c. Locked achievement (hidden):
      - Dark silhouette, question mark icon
      - Name shows "???"
      - Description shows "???"
      - Creates mystery/discovery feel

4. Section organization:
   - Could group by type (Milestones section, Hidden section) OR
   - Single grid with hidden achievements at end
   - Claude's discretion on organization

5. Total progress (optional):
   - Show "X/Y Achievements Unlocked" at top
   - Claude's discretion whether to include

6. Animation:
   - Cards stagger in on mount
   - Subtle hover effects on cards
   - Respect useReducedMotion

7. Export from index.ts
  </action>
  <verify>
    - Component compiles: `npx tsc --noEmit src/components/gauntlet/AchievementGallery.tsx`
    - Export added to index.ts
  </verify>
  <done>
    - Gallery displays all achievements
    - Unlocked achievements show full details with date
    - Locked milestones show requirements
    - Hidden achievements show "???" mystery state
    - Responsive grid layout
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire progress into GauntletModeScreen</name>
  <files>src/components/gauntlet/GauntletModeScreen.tsx</files>
  <action>
Add progress indicator to gameplay screen:

1. Import AchievementProgress component

2. Position near StreakCounter during gameplay:
   - Find where StreakCounter is rendered
   - Add AchievementProgress below or beside it
   - Only show during 'gameplay' screen state (not during transitions)

3. Pass currentStreak from gauntletStore to component

4. Styling:
   - Ensure it doesn't overlap other UI
   - Should be visible but not prominent
   - Consider mobile layout (may need different positioning)
  </action>
  <verify>
    - Component compiles: `npx tsc --noEmit src/components/gauntlet/GauntletModeScreen.tsx`
    - Progress rendered: grep for AchievementProgress in file
  </verify>
  <done>
    - Progress indicator visible during gauntlet gameplay
    - Updates as streak changes
    - Positioned appropriately with StreakCounter
  </done>
</task>

<task type="auto">
  <name>Task 4: Main menu achievements button and gallery routing</name>
  <files>src/components/ModeSelection.tsx, src/app/page.tsx</files>
  <action>
Add "Achievements" button to main menu and handle gallery display:

1. In page.tsx:
   - Add state: showAchievementGallery: boolean (default false)
   - Create handler: handleShowAchievements = () => setShowAchievementGallery(true)
   - Create handler: handleHideAchievements = () => setShowAchievementGallery(false)
   - Import AchievementGallery from gauntlet components
   - Render AchievementGallery when showAchievementGallery is true
     (Similar pattern to how Gauntlet mode is conditionally rendered)
   - Pass onBack={handleHideAchievements}

2. In ModeSelection.tsx:
   - Add prop: onShowAchievements: () => void
   - Add "Achievements" button below the three mode buttons
   - Style: Smaller than mode buttons, more subtle
   - Icon: Trophy or Award from lucide-react
   - Position: Could be in a row with other secondary actions, or standalone
   - Animation: Same entry animation pattern as mode buttons (staggered)

3. Wire up in page.tsx:
   - Pass onShowAchievements={handleShowAchievements} to ModeSelection
  </action>
  <verify>
    - Components compile: `npx tsc --noEmit`
    - Button renders: Check ModeSelection visually
    - Gallery displays: Click button opens gallery
  </verify>
  <done>
    - Achievements button visible on main menu
    - Clicking opens achievement gallery
    - Back button returns to main menu
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Achievement progress display and gallery with main menu access</what-built>
  <how-to-verify>
    1. Go to http://localhost:3000
    2. Verify "Achievements" button visible below mode selection buttons
    3. Click "Achievements" -> gallery opens
    4. Verify milestone achievements show locked state with requirements
    5. Verify hidden achievements show "???" state
    6. Click back -> returns to main menu
    7. Start Gauntlet -> verify progress indicator visible during gameplay
    8. Progress should show "X/Y to [next milestone]" format
    9. Win duels -> verify progress updates
    10. Defeat 5 opponents -> check gallery shows "Dice Apprentice" (or first milestone) as unlocked with date
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. TypeScript compilation: `npm run build`
2. Dev server: `npm run dev`
3. Main menu shows Achievements button
4. Gallery displays correctly with locked/unlocked states
5. Progress indicator visible during gameplay
6. Achievement unlock shows in gallery after earning
</verification>

<success_criteria>
- Progress indicator shows during gauntlet runs
- Achievement gallery accessible from main menu
- Locked achievements display appropriately (milestone vs hidden)
- Unlocked achievements show name, description, unlock date
- Full flow works: main menu -> gallery -> back
- Full flow works: gameplay -> milestone -> gallery shows unlocked
</success_criteria>

<output>
After completion, create `.planning/phases/22-achievement-system/22-03-SUMMARY.md`
</output>
